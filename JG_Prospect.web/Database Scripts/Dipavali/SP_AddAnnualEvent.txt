
GO
/****** Object:  StoredProcedure [dbo].[AddAnnualEvent]    Script Date: 19-01-2017 PM 03:32:45 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
ALTER PROCEDURE [dbo].[AddAnnualEvent] 
	-- Add the parameters for the stored procedure here
	@Eventname varchar(100),
    @EventDate datetime,
	@EventAddedBy int,
	@EventEndDate datetime,
	@EventStartTime varchar(50),
	@EventEndTime varchar(50),
	@EventLoc varchar(400),
	@EventDesc text,
	@EventColor varchar(50),
	@EventCal int,
	@EventFile varchar(400),
	@EventType int,
	@EventRepeat int,
	@TimeZone varchar(400),
	@RecurrenceRule nvarchar(1000),
	@MaxOccurance int,
	@Interval int,
	@EventId int
	
AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	if @EventId=0

		begin
			-- Insert statements for procedure here
			insert into dbo.tbl_AnnualEvents 
			(EventName,EventDate,EventAddedBy,EventEndDate,EventStartTime,EventEndTime,EventLoc,
			EventDesc,EventColor,EventCal,EventFile,EventType,EventRepeat,
			RecurrenceRule,TimeZone,MaxOccurance,Interval)
			values
			(@Eventname,@EventDate,@EventAddedBy,@EventEndDate,@EventStartTime,@EventEndTime,@EventLoc,@EventDesc,
			@EventColor,@EventCal,@EventFile,@EventType,@EventRepeat,
			@RecurrenceRule,@TimeZone,@MaxOccurance,@Interval)

		end

	else
		
		begin
			update dbo.tbl_AnnualEvents  set
			EventName=@EventName,EventDate=@EventDate,EventEndDate=@EventEndDate
			,EventStartTime=@EventStartTime,EventEndTime=@EventEndTime,EventLoc=@EventLoc,
			EventDesc=@EventDesc,EventColor=@EventColor,EventCal=@EventCal,
			EventFile=@EventFile,EventType=@EventType,EventRepeat=@EventRepeat,
			RecurrenceRule=@RecurrenceRule,TimeZone=@TimeZone,
			MaxOccurance=@MaxOccurance,Interval=@Interval
			where ID=@EventId

		end

END



